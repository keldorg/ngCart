/*! ngCart v1.0.1 */
 "use strict";angular.module("ngCart",["ngCart.directives"]).config([function(){}]).provider("$ngCart",function(){this.$get=function(){}}).run(["$rootScope","ngCart","ngCartItem","store",function(a,b,c,d){a.$on("ngCart:change",function(){b.$save()}),angular.isObject(d.get("cart"))?b.$restore(d.get("cart")):b.init()}]).service("ngCart",["$rootScope","$window","ngCartItem","store",function(a,b,c,d){this.init=function(){this.$cart={shipping:null,items:[],taxes:[],localId:null,shippingAddress:{name:String,phone:String,street:String,number:String,dir1:String,dir2:String,postalCode:String,province:String,country:String},billingAddress:{fiscalName:String,phone:String,street:String,number:String,dir1:String,dir2:String,postalCode:String,province:String,country:String,taxNumber:String,taxType:String}}},this.addItem=function(b,d,e,f,g,h,i,j){var k=this.getItemById(b);if("object"==typeof k)k.setQuantity(f,!1),a.$broadcast("ngCart:itemUpdated",k);else{var l=new c(b,d,e,f,g,h,i,j);this.$cart.items.push(l),a.$broadcast("ngCart:itemAdded",l)}a.$broadcast("ngCart:change",{})},this.getItemById=function(a){var b=this.getCart().items,c=!1;return angular.forEach(b,function(b){b.getId()===a&&(c=b)}),c},this.setShipping=function(a){return this.$cart.shipping=a,this.getShipping()},this.getShipping=function(){return 0===this.getCart().items.length?0:this.getCart().shipping},this.setCart=function(a){return this.$cart=a,this.getCart()},this.getCart=function(){return this.$cart},this.setLocalId=function(a){return this.$cart.localId=a,this.getLocalId()},this.getLocalId=function(){return this.$cart.localId},this.setShippingAddress=function(a){return this.$cart.shippingAddress=a,this.getShippingAddress()},this.getShippingAddress=function(){return this.$cart.shippingAddress},this.setBillingAddress=function(a){return this.$cart.billingAddress=a,this.getBillingAddressAddress()},this.getBillingAddress=function(){return this.$cart.billingAddress},this.getItems=function(){return this.getCart().items},this.getTaxes=function(){var a=[];return angular.forEach(this.getCart().items,function(b){var c=b.getTax();if(c){c.value=+b.getTaxValue();var d=!1;a.length?(angular.forEach(a,function(a){a.name===c.name&&a.tax===c.tax&&(d=!0,a.value=parseFloat(a.value+c.value))}),d||a.push(c)):a.push(c)}}),a},this.getTaxesTotalValue=function(){var a=this.getTaxes(),b=0;return angular.forEach(a,function(a){b+=a.value}),+parseFloat(b).toFixed(2)},this.getTotalItems=function(){var a=0,b=this.getItems();return angular.forEach(b,function(b){a+=b.getQuantity()}),a},this.getTotalUniqueItems=function(){return this.getCart().items.length},this.getSubTotal=function(){var a=0;return angular.forEach(this.getCart().items,function(b){a+=b.getSubTotal()}),+parseFloat(a).toFixed(2)},this.totalCost=function(){return+parseFloat(this.getSubTotal()+this.getShipping()+this.getTaxesTotalValue()).toFixed(2)},this.removeItem=function(b){var c=this.$cart.items.splice(b,1)[0]||{};a.$broadcast("ngCart:itemRemoved",c),a.$broadcast("ngCart:change",{})},this.removeItemById=function(b){var c,d=this.getCart();angular.forEach(d.items,function(a,c){a.getId()===b&&(a=d.items.splice(c,1)[0]||{})}),this.setCart(d),a.$broadcast("ngCart:itemRemoved",c),a.$broadcast("ngCart:change",{})},this.empty=function(){a.$broadcast("ngCart:change",{}),this.$cart.items=[],b.localStorage.removeItem("cart")},this.isEmpty=function(){return this.$cart.items.length>0?!1:!0},this.toObject=function(){if(0===this.getItems().length)return!1;var a=[];return angular.forEach(this.getItems(),function(b){a.push(b.toObject())}),{localId:this.getLocalId(),shippingAddress:this.getShippingAddress(),billingAddress:this.getBillingAddress(),shipping:this.getShipping(),taxTotalValue:this.getTaxesTotalValue(),tax:this.getTax(),taxes:this.getTaxes(),subTotal:this.getSubTotal(),totalCost:this.totalCost(),items:a}},this.$restore=function(a){var b=this;b.init(),b.$cart.shipping=a.shipping,b.$cart.tax=a.tax,angular.forEach(a.items,function(a){b.$cart.items.push(new c(a._id,a._name,a._price,a._quantity,a._data,a._weight,a._tax.taxPercent,a._tax.taxName))}),this.$save()},this.$save=function(){return d.set("cart",JSON.stringify(this.getCart()))}}]).factory("ngCartItem",["$rootScope","$log",function(a,b){var c=function(a,b,c,d,e,f,g,h){this.setId(a),this.setName(b),this.setPrice(c),this.setQuantity(d),this.setWeight(f),this.setTax({name:h,tax:g}),this.setData(e)};return c.prototype.setId=function(a){a?this._id=a:b.error("An ID must be provided")},c.prototype.getId=function(){return this._id},c.prototype.setName=function(a){a?this._name=a:b.error("A name must be provided")},c.prototype.getName=function(){return this._name},c.prototype.setPrice=function(a){var c=parseFloat(a);c?0>=c?b.error("A price must be over 0"):this._price=c:b.error("A price must be provided")},c.prototype.getPrice=function(){return this._price},c.prototype.setQuantity=function(a,c){var d=parseInt(a);d%1===0?(c===!0?this._quantity+=d:this._quantity=d,this._quantity<1&&(this._quantity=1)):(this._quantity=1,b.info("Quantity must be an integer and was defaulted to 1"))},c.prototype.getQuantity=function(){return this._quantity},c.prototype.setData=function(a){a&&(this._data=a)},c.prototype.getData=function(){return this._data?this._data:void b.info("This item has no data")},c.prototype.setWeight=function(a){a&&(this._weight=a)},c.prototype.getWeight=function(){return this._weight?this._weight:void b.info("This item has no weight")},c.prototype.setTax=function(a){a.tax=parseFloat(a.tax),a&&(this._tax=a)},c.prototype.getTax=function(){return this._tax?this._tax:void b.info("This item has no tax")},c.prototype.getTaxValue=function(){return this._tax?+parseFloat(this.getQuantity()*this.getPrice()*this._tax.tax).toFixed(2):void b.info("This item has no tax")},c.prototype.getTotal=function(){var a=parseFloat(this.getTaxValue());return+parseFloat(this.getQuantity()*this.getPrice()+a).toFixed(2)},c.prototype.getSubTotal=function(){return+parseFloat(this.getQuantity()*this.getPrice()).toFixed(2)},c.prototype.toObject=function(){return{id:this.getId(),name:this.getName(),price:this.getPrice(),quantity:this.getQuantity(),data:this.getData(),weight:this.getWeight(),subTotal:this.getSubTotal(),taxValue:this.getTaxValue(),tax:this.getTax(),total:this.getTotal()}},c}]).service("store",["$window",function(a){return{get:function(b){if(a.localStorage.getItem(b)){var c=angular.fromJson(a.localStorage.getItem(b));return JSON.parse(c)}return!1},set:function(b,c){return void 0===c?a.localStorage.removeItem(b):a.localStorage.setItem(b,angular.toJson(c)),a.localStorage.getItem(b)}}}]).controller("CartController",["$scope","ngCart",function(a,b){a.ngCart=b}]).value("version","1.0.0"),angular.module("ngCart.directives",["ngCart.fulfilment"]).controller("CartController",["$scope","ngCart",function(a,b){a.ngCart=b}]).directive("ngcartAddtocart",["ngCart",function(a){return{restrict:"E",controller:"CartController",scope:{id:"@",name:"@",quantity:"@",quantityMax:"@",price:"@",weight:"@",taxpercent:"@",taxname:"@",data:"="},transclude:!0,templateUrl:function(a,b){return"undefined"==typeof b.templateUrl?"template/ngCart/addtocart.html":b.templateUrl},link:function(b,c,d){b.attrs=d,b.inCart=function(){return a.getItemById(d.id)},b.inCart()?b.q=a.getItemById(d.id).getQuantity():b.q=parseInt(b.quantity),b.qtyOpt=[];for(var e=1;e<=b.quantityMax;e++)b.qtyOpt.push(e)}}}]).directive("ngcartCart",[function(){return{restrict:"E",controller:"CartController",scope:{},templateUrl:function(a,b){return"undefined"==typeof b.templateUrl?"template/ngCart/cart.html":b.templateUrl},link:function(a,b,c){}}}]).directive("ngcartSummary",[function(){return{restrict:"E",controller:"CartController",scope:{},transclude:!0,templateUrl:function(a,b){return"undefined"==typeof b.templateUrl?"template/ngCart/summary.html":b.templateUrl}}}]).directive("ngcartCheckout",[function(){return{restrict:"E",controller:["$rootScope","$scope","ngCart","fulfilmentProvider",function(a,b,c,d){b.ngCart=c,b.checkout=function(){d.setService(b.service),d.setSettings(b.settings),d.checkout().success(function(b,c,d,e){a.$broadcast("ngCart:checkout_succeeded",b)}).error(function(b,c,d,e){a.$broadcast("ngCart:checkout_failed",{statusCode:c,error:b})})}}],scope:{service:"@",settings:"="},transclude:!0,templateUrl:function(a,b){return"undefined"==typeof b.templateUrl?"template/ngCart/checkout.html":b.templateUrl}}}]),angular.module("ngCart.fulfilment",[]).service("fulfilmentProvider",["$injector",function(a){this._obj={service:void 0,settings:void 0},this.setService=function(a){this._obj.service=a},this.setSettings=function(a){this._obj.settings=a},this.checkout=function(){var b=a.get("ngCart.fulfilment."+this._obj.service);return b.checkout(this._obj.settings)}}]).service("ngCart.fulfilment.log",["$q","$log","ngCart",function(a,b,c){this.checkout=function(){var d=a.defer();return b.info(c.toObject()),d.resolve({cart:c.toObject()}),d.promise}}]).service("ngCart.fulfilment.http",["$http","ngCart",function(a,b){this.checkout=function(c){return a.post(c.url,{data:b.toObject(),options:c.options})}}]).service("ngCart.fulfilment.paypal",["$http","ngCart",function(a,b){}]);